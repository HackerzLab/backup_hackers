# Vol11

## 各レベルの問題数
* レベル1相当：問
* レベル2相当：問
* レベル3相当：問
* レベル4相当：問
* レベル5相当：問

## 問題概要
* 問1(レベル1)：
* 問2(レベル2)：
* 問3(レベル2)：
* 問4(レベル2)：
* 問5(レベル2)：
* 問6(レベル4)：解析してみよう1
* 問7(レベル5)：解析してみよう2
* 問8(レベル5)：解析してみよう3
* 問9(レベル5)：解析してみよう4
* 問10(レベル5)：解析してみよう5

---

# 問6(レベル4)：解析してみよう1
次のファイルをダウンロードしてください。
実行して正しい入力を行うと、次の実行結果が表示されます。
実行結果の***の部分に入る文字列を入力してください。

Your FLAG is HLH={***}

## 添付ファイル：HLHQuiz_whatspass1.zip

## ヒント
* 1：解凍後、index.htmlをブラウザで開いてみよう
* 2：index.htmlのソースを確認してみよう
* 3：JavaScriptで書かれた部分に注目しよう
* 4：ボタンを押すと「checkPassword()」関数で入力値を判定しているよ
* 5：base64は「http://www.convertstring.com/ja/EncodeDecode/Base64Decode」で復元できます

## 解答：Falcon

## 解説：

```
JavaScriptの問題です。

index.htmlのソースを見ると、46行目〜48行目で、
ボタンを押すと「checkPassword()」に入力内容が送られてます。

肝心のcheckPassword関数がどこにも見当たりません。
45行目「eval($.base64.atob(a, true));」とありますが、
変数aの定義がどこにもありません。

そこで、6行目〜9行目で他のJavaScriptファイルを読み込んでいる部分に着目します。

HLHQuiz_whatspass.min.jsというファイルに変数aが定義されていますが中身が読めません。
・中身の最後が「==」で終わっていること、
・index.htmlの45行目でbase64という文字があること
このことからbase64で変換されていることが推測できます。

変数aの中身、「dmFyIFBBU1MgPSAiaGFja2hhY2toYWNrIjsKdmFyIEZMQUcgPSAiRmFsY29uIjsKCnZhciBjaGVja1Bhc3N3b3JkID0gZnVuY3Rpb24odmFsdWUpIHsKICBpZiAodmFsdWUgPT0gUEFTUykgewogICAgYWxlcnQoIllvdXIgRkxBRyBpcyBITEg9IitGTEFHKTsKICB9IGVsc2UgewogICAgYWxlcnQoIlRoYXTigJlzIHRvbyBiYWQuIik7CiAgfQp9Ow==」
をbase64で複合化することで、JavaScriptのコードが確認できます。

パスワードはこちら
hackhackhack
```

# 問7(レベル5)：解析してみよう2
次のファイルをダウンロードしてください。
実行して正しい入力を行うと、次の実行結果が表示されます。
実行結果の***の部分に入る文字列を入力してください。

Your FLAG is HLH={***}

## 添付ファイル：HLHQuiz_whatspass2.zip

## ヒント
* 1：解凍後、index.htmlをブラウザで開いてみよう
* 2：HLHQuiz_whatspass.jsを解析してみよう
* 3：入力値（パスワード）の判定結果は開発者ツールに出力されるよ
* 4：base64は使ってないよ
* 5：変数名が長いだけ。頑張って解析しよう

## 解答：THIRD-i

## 解説：

```
この問題は入力してもダイアログメッセージは表示されず開発者ツールにログが出力されます。

コードを見ると、base64で変換されているようですが、
ヒントにもあるようにただひたすら変数名が長いコードです。
そして改行や空白を省略しています。
こういったプログラムを読みにくくすることを「難読化」など言ったりします。

通常のプログラミングでは難読化することはほとんどありませんが、
マルウェアなど悪意のあるソフトウェアは、
アンチウイルスソフトやサーバー管理者の目をすり抜ける目的で、
難読化をすることがあります。(悪さするやつは100%やってるぅ！！)

※最近のアンチウイルスソフトはコードだけでなく、
プログラムの振る舞いを見てマルウェア判定もしますが・・・

使い勝手の良いエディタなりIDEを使って長い変名をわかりやすい名前に変更すると良いです。
イケてないエディタだと長すぎて読みきれなかったりエディタが落ちます。

後は好奇心と根気で答えを探すのみです。
ちなみにパスワードはこちら。
25d251d054d241a5f9fb2902133d78911bb2b5ebb649559dc1731b15aae1
```

---

# 問8(レベル5)：解析してみよう3
次のファイルをダウンロードしてください。
実行して正しい入力を行うと、次の実行結果が表示されます。
実行結果の***の部分に入る文字列を入力してください。

Your FLAG is HLH={***}

## 添付ファイル：HLHQuiz_whatspass3.zip

## ヒント
* 1：解凍後、index.htmlをブラウザで開いてみよう
* 2：HLHQuiz_whatspass.jsを解析してみよう
* 3：コードが難読化されてるので見やすくしよう
* 4：「文字列.split("|").join("")」をすることで「"|"」を除去しています
* 5：「PASS」も「FLAG」も「"|"」を除去してみよう

## 解答：BLOODY-X

## 解説：

```
この問題も軽く難読化されています。
難読化されたコードを見やすくするサイトはいくつもあります。
http://prettydiff.com/?m=beautify

コードを見やすくした後は、ヒントにあるように、
「PASS」も「FLAG」も「"|"」を除去すると答えがわかります。

コードの中で、「console.log(表示したい文字列なり変数);」とすると
内容がブラウザの開発者ツールでログとして確認できますので、
自分でコードをいじって、内容を確認したい箇所でログを出力するのも手です。

※ちなみに、プログラムのなかで変数の中身(内容)を知りたい場合、
このようにログに出力するなりして確認することは、
プログラマーの現場でもよく使います。
(私はprintfデバッグとか呼んでます)

パスワードはこちら
4927aa0ca4a2b0d9
```


# 問9(レベル5)：解析してみよう4
次のファイルをダウンロードしてください。
実行して正しい入力を行うと、次の実行結果が表示されます。
実行結果の***の部分に入る文字列を入力してください。

Your FLAG is HLH={***}

## 添付ファイル：HLHQuiz_whatspass4.zip

## ヒント
* 1：解凍後、index.htmlをブラウザで開いてみよう
* 2：HLHQuiz_whatspass.jsを解析してみよう
* 3：何やら「シーザー暗号」って書いてあるよ
* 4：復号化処理のコメントを見るとアルファベット以外は変換しないらしい・・・
* 5：「nxvdndeholhyhu」を復号化してみてよう

## 解答：obs-4011

## 解説：
```
HLHQuiz_whatspass.jsのコードを見るとPASSやFLAGや書いてありますが、
そのまま入力しても答えは出てきません。

シーザー暗号で復号化する必要がありますね。

「nxvdndeholhyhu」を復号化すると、
「kusakabeliever」になります。

パスワードは、
kusakabeliever
```

# 問10(レベル5)：解析してみよう5
次のファイルをダウンロードしてください。
実行して正しい入力を行うと、次の実行結果が表示されます。
実行結果の***の部分に入る文字列を入力してください。

Your FLAG is HLH={***}

## 添付ファイル：HLHQuiz_whatspass5.zip

## ヒント
* 1：解凍後、index.htmlをブラウザで開いてみよう
* 2：HLHQuiz_whatspass.min.jsを見てみよう
* 3：HLHQuiz_whatspass.min.jsの解析は難しい・・・
* 4：他にヒントがないか探そう
* 5：htmlのソースを詳しく見てみよう

## 解答：BLOODY MONDAY

## 解説：
```
この問題もJavaScriptのコードが難読化されています。

専用ツールを使って難読化しています。
JavaScript Obfuscator Tool
https://javascriptobfuscator.herokuapp.com/

復元しようと思っても困難です。

ヒントにあるようにHTMLのソースをよく見てみましょう。
index.htmlの7行目にスタイルシートを読み込んでいそうな箇所がコメントになっています。
ファイル名（みたいな）箇所が「this password:hackerz_hkt」とありますので、
パスワードは「hackerz_hkt」です。

```

元のコードはこちら
```
var PASS = "hackerz_hkt";
var FLAG = "BLOODY MONDAY";

var checkPassword = function(value) {
  if (value == PASS) {
    console.log("Your FLAG is HLH="+FLAG);
  } else {
    console.log("That's too bad.");
  }
};
```

---

# Vol10リバイバル

やられサイトを攻略してみようシリーズ（Vol9の9,10問目、Vol10の8,9,10問目）のURLは以下になります。

http://www.sk-ing.com:3031

個人サーバなので他にものせてますが、
そっちはいじめないでください。

---

# 今回参考になった便利ツール

## 圧縮されたjsの展開
http://prettydiff.com/?m=beautify

## base64エンコード・でコードサービス 
http://www.convertstring.com/ja/EncodeDecode/Base64Decode

## コード圧縮
http://solufa.io/ticker/

## jQueryでbase64変換
https://github.com/yckart/jquery.base64.js/

---

# ハッカークイズのレベルわけ

だいたいこんな感じ。

## LEVEL1（初心者向け　非エンジニア）
 
* ネットで調べ物(検索)ができる

## LEVEL2（中級者向け　SE・プログラマ経験者）
* ターミナルやコマンドプロンプト（真っ黒画面）をつかったことがある
* Unix/Linuxを使ったことがある
* データベース(SQL)を使ったことがある
* Web系の開発をしたことがある

## LEVEL3（中級者向け② 　現役エンジニア向け）
* HTTPのシーケンスがわかる
* ネットワークコマンドがある程度わかる
* OS(Linux/Unix)のコマンドがある程度わかる
* WebサーバやDBサーバの構築をしたことがある
* ルータの設定をしたことがある

## LEVEL4（上級者向け 　わりとガチな人向け）
* 普段からシステムの保守管理をやっている
* ネットワークコマンドやOSのコマンドを普段から使っている
* XSS,OSコマンドインジェクションがわかる
* バイナリエディタを使ったことがある
* GUIなんかよりCUIだろの人
* Metasploitやハニーポット勉強中の人
* セキュリティベンダやコミュニティのツイートをマメにチェックしている人
* セキュリティ関連のIT記事をかかさずチェックしている人

## LEVEL5（超上級者向け 　本当に好きな人向け）
* CTFをやっていますの人
* Metasploit普段から使っている人
* 迷惑メールで添付ファイルが付いていると喜ぶ人
* ハニーポットでウハウハする人
* 攻撃コードやマルウェアを手に入れてマジ解析している人
* 実際やってる人

レベル4はセキュリティ系に興味のある人向け。  
レベル5は完全にガチな人向けの問題。


それにしても・・・
ランサム流行ってますね。
検体入手して解析してくれんかいな。
