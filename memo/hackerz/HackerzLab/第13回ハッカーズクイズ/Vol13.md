# Vol11
不十分なところがあるのでもう少し解説の追記しておきます


## 各レベルの問題数
* レベル1相当：3問
* レベル2相当：3問
* レベル3相当：2問
* レベル4相当：2問
* レベル5相当：問

## 問題概要
* 問1(レベル1)：通信方法 (ネットで調べる系問題)
* 問2(レベル1)：ちゃんとパケットを届けるには？　(ネットで調べる系問題)
* 問3(レベル2)：証明書の見方
* 問4(レベル2)：パケット解析①
* 問5(レベル4)：パケット解析②
* 問6(レベル4)：パケット解析③
* 問7(レベル1)：意識していますか？(拡張子について)
* 問8(レベル2):こんなことがありました(ネットで調べる系問題)
* 問9(レベル3):中身見えますか？①(拡張子の問題)
* 問10(レベル3)：中身見えますか？②(拡張子の問題)

今回のフラグはEVAの使徒の名前で行きました．
---

#問1(レベル1) 通信方法 

ネットワーク上の端末が他の端末と通信を行う際に，主に信頼性の高い通信と，通信時の負荷をあまりかけず高速に通信を行う2種類の方法があります．その2種類の組み合わせとして正しいものを選んでください．

## 選択肢
- A FWとDMZ
- B HTTPとHTTPS
- C MACとWINDOWS
- D TCPとUDP

## ヒント
* 1：知らない言葉は調べてみよう！
* 2：MACとWINDOWSはOSの名前ですね
* 3：FWはファイアーウォールですね
* 4：「トランスポート層　プロトコル」とか調べてみるといいかも？
* 5：HTTPSとかは信頼性が必ずある通信のことをいいます
## 解答: D
## 解説


それぞれの用語の説明
- FW FireWall
- DMZ 非武装地帯
- HTTP  HTMLなどのコンテンツの送受信にもちいられるプロトコル
- HTTPS  HTTPSを暗号化したもの
- TCP 信頼性・確実性を重視したデータ送受信。HTTP、HTTPS、POP3、SMTP、FTPなどと組み合わされて使われる。 ホームページ閲覧、メール送受信、ファイル転送など。 
- UDP　転送速度を重視したデータ送受信。動画ストリーミングなどで使われる。 


# 問2(レベル1)：ちゃんとパケットを届けるには？

TCPで通信する際に，最初に通信するための通路を確保します．その動作の名前を選んでください

## 選択肢
- A 3ウェイハンドシェイク
- B Switch
- C クラウド
- D MIME


## ヒント
* 1：調べてみよう
* 2：Nintendo Switch楽しいですね
* 3：クラウドはファイル保存に用いますよね
* 4：MINEはmailでテキスト以外を送ることができるようにしたものです
* 5：そうすると選択肢はあとひとつですね

## 解答： A

## 解説：
```
3 way handshakeはTCPで接続を確立するための手段．
手順は [wiki参照](https://ja.wikipedia.org/wiki/3%E3%82%A6%E3%82%A7%E3%82%A4%E3%83%BB%E3%83%8F%E3%83%B3%E3%83%89%E3%82%B7%E3%82%A7%E3%82%A4%E3%82%AF)

Switch はゲーム機(ネットワークエンジニアの方がいらっしゃたらL3，L２のイメージ)

クラウドはGoogle Drive,OneDrive,DropBoxなんかを思う浮かべると思いますが，ファイルを送信するいじょう信頼性は必ず必要なTCPを用いているので正しくない．(現役の方からすればAWSとかが出てくると思いますがそれだとDNS周りでUDP使ってるので違う，DNSSECはTCPですけどね)

MIMEはmailで英語のtext以外の規格を扱えるようにしたもの．例えば日本語，画像，音声などなど
```




# 問3(レベル2) : 証明書の見方
HackerzLab.博多のmastodonインスタンスに使用されているSSL証明書の公開鍵は何bitでしょうか，正しい数値を入力してください．
## ヒント
* 1：SSL証明書はブラウザから見れます．
* 2：ブラウザによって見方が違うので調べましょう
* 3：それが正しい証明書なのかURLをチェックしましょう
* 4：証明書が見れたら公開鍵を探してみよう
* 5：公開鍵のbit数をそのまま入力してください
## 解答 2048
## 解説
証明書の見方はそれぞれブラウザによって違うので省略．
そこから公開鍵の場所を調べて数字を入れてもらう．これで3問を通してL4からL５と暗号化の話までして，普段使っている通信の流れを知ってもらう．


# 問4(レベル2):パケット解析①
次のファイルをダウンロードしてください。
パケットを解析すると以下の文字列が得られます．
解析結果の***の部分に入る文字列を入力してください。

Your FLAG is HLH={***}

## 添付ファイル : HLHQuiz1.pcapng
## ヒント
* 1：パケット解析はwiresharkを使いましょう
* 2：GETをこのままではきちんと読むことができません
* 3：「URLエンコード」について調べてみよう
* 4：デコードしてみよう
* 5：このサイトを使ってみよう http://www.tagindex.com/tool/url.html

## 解答 ADAM
## 解説
```
パケットのInfoに注目，
Request URI: /Youre%20FLAG%20is%20HLH=%7BADAM%7D
からURL部分をデコードすると
Your FLAG is HLH={ADAM}

todo GETの説明

```

# 問5(レベル4) : パケット解析②
次のファイルをダウンロードしてください。
パケットを解析すると以下の文字列が得られます．
解析結果の***の部分に入る文字列を入力してください。

"Your FLAG is HLH"=> "***"
## 添付ファイル : HLHQuiz2.pcapng
## ヒント
* 1：Infoを見てみましょう
* 2：さっきはGETでしたね，今はなんになっていますか
* 3：POSTについて調べてみよう
* 4：HTML Form URL Encoded: application/x-www-form-urlencodedのタブを見てみよう
* 5：さあそれが答えです
## 解答 LILITH
## 解説
'''
この問題はPOSTなので
：HTML Form URL Encoded: application/x-www-form-urlencoded
を見てみてください
答えがそのままあります
'''



# 問6(レベル4) : パケット解析③
次のファイルをダウンロードしてください。
パケットを解析すると以下の文字列が得られます．
解析結果の***の部分に入る文字列を入力してください。

Your FLAG is HLH={***}
## 添付ファイル HLHQuiz3.pcapng
## ヒント
* 1：このパケットもPOSTですね
* 2：問5と同じところを見てみましょう
* 3：いつもどおりの暗号ですね
* 4：でもそれで解けてもなんなのでもうひと工夫してください
* 5：16進数を文字列に変換してみよう
## 解答 SACHIEL
## 解説
```
これもPOST　
base64でデコードのち16進数を文字列にすると答えがでます

base64コード 'MHg1MzQxNDM0ODQ5NDU0Yw==' 
16進数 "0x5341434849454c"

```


# 問7(レベル1) : 意識していますか?
もしあなたがこんな名前のファイルをダウンロードしました．さてこれは一体なんのファイルでしょう．
"hoge.eps"
##選択肢
- A プログラムが書かれたファイル
- B 画像ファイル
- C 昔のOfficeのファイル
- D pdfの別の表記

## ヒント
* 1：普段は見ない拡張子だと思います
* 2：epsという拡張子について調べてみよう 
* 3：pdfの拡張子はpdfです． 
* 4：プログラムが書かれているならepsで調べるとでてくるはずですね 
* 5：Officeのファイルでもないです
## 解答 B
## 解説
```
epsはLatexで推奨されている画像ファイルの拡張子
```



# 問8(レベル2) : こんなことがありました
ある日，普段の取引先だがmailアドレスが違うものを受信したAさん，件名には「至急」の文字が，添付されていたpdfを開いたら突然パソコンがウイスルに感染しました．さてこの拡張子は偽装されていたわけですが，本来なんの拡張子だったでしょう(windowsを想定してください)

## ヒント
* 1：見た目はpdfでした
* 2：どんな動作をしたでしょうか
* 3：実行権限を持つファイルはなにがあるでしょうか
* 4：
* 5：
## 解答 exe
## 解説
```
受け取ったメールには拡張子の偽装されたファイルが添付されている，ウイルスのプログラムが走るにはexeクラスの権限が必要　(.datとかもいくんですかね)

```


# 問9(レベル3) : 中身見えますか？①
次のファイルをダウンロードしてください．
そのファイルを開くとフラグが表示されます．


## 添付ファイル : HLHQuiz4.txt
## ヒント
* 1：txtのままでは開けませんね
* 2：macの人はfileコマンドを叩いてみましょう
* 3：windwosの方は開くソフトを変えてみましょう
* 4：みなさんの身近にあるファイルですよ
* 5：拡張子を変えてみてください
## 解答 SHAMSHEL
## 解説
```
そのままでは開くことはできない．
mac,unixならfileコマンドを叩いてもらって確認をする．
windwosの方はバイナリエディタから判断or開くソフトをいろいろ試す
拡張子をpngに変更してもらうと中の文字を読むことができます


IEはHTML5が使えないので見えちゃう
```


# 問10(レベル3) : 中身見えますか？②
次のファイルをダウンロードしてください．
そのファイルを開くと以下の文字列が表示されます．
表示された***の正しく変換した文字列を入力してください。

Your FLAG is HLH={***}

## 添付ファイル :HLHQuiz5.png
## ヒント
* 1：今度は画像ファイルですね
* 2：またfileコマンドを叩いてみましょう
* 3：ファイルを開いてもすぐに正解はでません
* 4：安定の暗号ですね
* 5：
## 解答 RAMIEL
## 解説
```
次はpng->txtに拡張子を変換してもらいましょう．
base64を戻したらできます

もとの文字列
-> Your FLAG is HLH = {IFJBTUlFTA==}
base64デコード
-> Your FLAG is HLH = {RAMIEL}
```


# 今回参考になった便利ツール

## URLエンコードエンコードデコード
http://www.tagindex.com/tool/url.html




# ハッカークイズのレベルわけ

だいたいこんな感じ。

## LEVEL1（初心者向け　非エンジニア）

* ネットで調べ物(検索)ができる

## LEVEL2（中級者向け　SE・プログラマ経験者）
* ターミナルやコマンドプロンプト（真っ黒画面）をつかったことがある
* Unix/Linuxを使ったことがある
* データベース(SQL)を使ったことがある
* Web系の開発をしたことがある

## LEVEL3（中級者向け② 　現役エンジニア向け）
* HTTPのシーケンスがわかる
* ネットワークコマンドがある程度わかる
* OS(Linux/Unix)のコマンドがある程度わかる
* WebサーバやDBサーバの構築をしたことがある
* ルータの設定をしたことがある

## LEVEL4（上級者向け 　わりとガチな人向け）
* 普段からシステムの保守管理をやっている
* ネットワークコマンドやOSのコマンドを普段から使っている
* XSS,OSコマンドインジェクションがわかる
* バイナリエディタを使ったことがある
* GUIなんかよりCUIだろの人
* Metasploitやハニーポット勉強中の人
* セキュリティベンダやコミュニティのツイートをマメにチェックしている人
* セキュリティ関連のIT記事をかかさずチェックしている人

## LEVEL5（超上級者向け 　本当に好きな人向け）
* CTFをやっていますの人
* Metasploit普段から使っている人
* 迷惑メールで添付ファイルが付いていると喜ぶ人
* ハニーポットでウハウハする人
* 攻撃コードやマルウェアを手に入れてマジ解析している人
* 実際やってる人

レベル4はセキュリティ系に興味のある人向け。  
レベル5は完全にガチな人向けの問題。


@auther nkchan